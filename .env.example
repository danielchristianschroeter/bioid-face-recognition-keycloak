# BioID Face Recognition Extension Environment Configuration
# Copy this file to .env and configure with your actual values

# =============================================================================
# REQUIRED CONFIGURATION
# =============================================================================

# BioID BWS Credentials (Required)
# Get these from https://bwsportal.bioid.com/register
BWS_CLIENT_ID=your_bws_client_id_here
BWS_KEY=your_bws_secret_key_here

# =============================================================================
# BIOID SERVICE CONFIGURATION
# =============================================================================

# BioID Service Endpoint
BWS_ENDPOINT=.bws-eu.bioid.com
BWS_JWT_EXPIRE_MINUTES=60

# Verification Settings
VERIFICATION_THRESHOLD=0.015
VERIFICATION_MAX_RETRIES=3
VERIFICATION_TIMEOUT_SECONDS=4
ENROLLMENT_TIMEOUT_SECONDS=7

# Template Management
TEMPLATE_TTL_DAYS=730
TEMPLATE_CLEANUP_INTERVAL_HOURS=24
TEMPLATE_TYPE=STANDARD
TEMPLATE_ENCRYPTION_ENABLED=true

# =============================================================================
# LIVENESS DETECTION CONFIGURATION
# =============================================================================

# BioID BWS Liveness Detection Modes:
# The BioID Web Service automatically determines the liveness detection mode based on 
# the number of images and tags provided in the LivenessDetection API call:
#
# PASSIVE MODE (1 image):
#   - Texture-based liveness detection (ALWAYS performed by BWS)
#   - Analyzes image properties to detect spoofing attempts
#   - Fastest mode but provides basic protection
#
# ACTIVE MODE (2 images):
#   - Passive liveness detection on both images (automatic)
#   - Motion-based 3D detection between consecutive images
#   - Requires natural head movement between captures
#   - Better security than passive-only mode
#
# CHALLENGE-RESPONSE MODE (2 images with tags):
#   - All passive and active liveness detection (automatic)
#   - Additional validation of specific head movement directions
#   - Tags specify required directions: UP, DOWN, LEFT, RIGHT
#   - Highest security level, defeats deepfakes and recorded videos

# Active liveness detection (requires 2 images)
# When enabled, the system will capture 2 images for motion-based detection
# Note: Passive liveness is always performed by BWS - no configuration needed
LIVENESS_ACTIVE_ENABLED=true

# Challenge-response liveness detection (requires 2 images with direction tags)
# Validates that head moved in the specific requested direction (UP/DOWN/LEFT/RIGHT)
# Provides highest security against deepfakes and recorded videos
LIVENESS_CHALLENGE_RESPONSE_ENABLED=false

# Liveness confidence threshold (0.0-1.0)
# Higher values = stricter liveness requirements
# Recommended: 0.5 for balanced security/usability, 0.7+ for high security
LIVENESS_CONFIDENCE_THRESHOLD=0.5

# Maximum additional processing time for liveness detection (milliseconds)
# Limits how much extra time liveness detection can add to authentication
LIVENESS_MAX_OVERHEAD_MS=200

# Adaptive liveness mode
# Automatically adjusts liveness requirements based on image quality and risk factors
LIVENESS_ADAPTIVE_MODE=false

# Fallback to password authentication
# Allow users to use password if liveness detection fails repeatedly
# Recommended: false for better security
LIVENESS_FALLBACK_TO_PASSWORD=false

# Challenge generation settings (for challenge-response mode)
# Number of challenge directions to request (1-4, recommended: 1-2)
LIVENESS_CHALLENGE_COUNT=1
# Timeout for user to complete challenge directions (seconds)
LIVENESS_CHALLENGE_TIMEOUT_SECONDS=30

# =============================================================================
# BWS MANAGEMENT API CONFIGURATION (Admin Role)
# =============================================================================

# BWS Management API Configuration
# Required for bws-admin role functionality to manage face templates
# Get these credentials from https://bwsportal.bioid.com (User Profile)

# BWS Management API endpoint
BWS_MANAGEMENT_API_URL=https://bwsportal.bioid.com/api

# Your BWS Portal email address (used for authentication)
BWS_MANAGEMENT_EMAIL=your-email@example.com

# Your BWS Portal API key (found in User Profile)
# IMPORTANT: Keep this secret! Never commit to version control
BWS_MANAGEMENT_API_KEY=YOUR_BWS_MANAGEMENT_API_KEY

# BWS Client ID for Management API (usually same as BWS_CLIENT_ID)
BWS_MANAGEMENT_CLIENT_ID=${BWS_CLIENT_ID}

# JWT token expiration for Management API (minutes)
BWS_MANAGEMENT_JWT_EXPIRE_MINUTES=15

# Enable/disable admin features
BWS_ADMIN_ENABLED=true

# Admin API rate limiting (requests per minute)
BWS_ADMIN_RATE_LIMIT_REQUESTS_PER_MINUTE=60

# Admin audit logging
BWS_ADMIN_AUDIT_ENABLED=true
BWS_ADMIN_AUDIT_LOG_LEVEL=INFO

# =============================================================================
# GRPC AND NETWORKING CONFIGURATION
# =============================================================================

# gRPC Connection Settings
GRPC_CHANNEL_POOL_SIZE=5
GRPC_KEEP_ALIVE_TIME_SECONDS=30
GRPC_RETRY_MAX_ATTEMPTS=3
GRPC_RETRY_BACKOFF_MULTIPLIER=2.0

# Health Check Settings
HEALTH_CHECK_INTERVAL_SECONDS=30
HEALTH_CHECK_TIMEOUT_SECONDS=5

# =============================================================================
# REGIONAL AND DATA RESIDENCY CONFIGURATION
# =============================================================================

# Regional Settings
REGIONAL_PREFERRED_REGION=EU
REGIONAL_DATA_RESIDENCY_REQUIRED=false
REGIONAL_FAILOVER_ENABLED=true
REGIONAL_LATENCY_THRESHOLD_MS=1000

# =============================================================================
# KEYCLOAK CONFIGURATION
# =============================================================================

# Keycloak Admin Configuration
KEYCLOAK_ADMIN=admin
KEYCLOAK_ADMIN_PASSWORD=admin123

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# PostgreSQL Database Configuration (Optional - uses defaults if not set)
# POSTGRES_DB=keycloak
# POSTGRES_USER=keycloak
# POSTGRES_PASSWORD=keycloak

# =============================================================================
# AUDIT AND COMPLIANCE CONFIGURATION
# =============================================================================

# Audit Configuration (System Properties - set via JVM args or config files)
# bioid.audit.detailed.enabled=true
# bioid.audit.retention.days=365
# bioid.audit.cleanup.enabled=false
# bioid.audit.siem.enabled=false
# bioid.audit.siem.endpoint=
# bioid.audit.siem.apikey=
# bioid.audit.compliance.enabled=true
# bioid.audit.log.level=INFO
# bioid.audit.batch.size=1000
# bioid.audit.encrypt.sensitive=true
# bioid.audit.directory=

# =============================================================================
# REPORTING AND STORAGE CONFIGURATION
# =============================================================================

# Reports Configuration (System Properties - set via JVM args or config files)
# bioid.reports.directory=

# =============================================================================
# DEBUG AND DEVELOPMENT CONFIGURATION
# =============================================================================

# Debug Settings (System Properties - set via JVM args or config files)
# bioid.debug.enabled=false
# bioid.test.mode=false

# Image Debug Storage
# When enabled, saves all images sent to BWS locally for debugging
# WARNING: This stores biometric data locally - use only in development!
# Images are organized by: {DEBUG_IMAGE_STORAGE_PATH}/{username}/{operation}/{timestamp}/
DEBUG_IMAGE_STORAGE_ENABLED=false
DEBUG_IMAGE_STORAGE_PATH=./debug-images
# Include metadata JSON file with each image (user, operation, timestamp, result)
DEBUG_IMAGE_STORAGE_INCLUDE_METADATA=true

# Enrollment Configuration (System Properties - set via JVM args or config files)
# bioid.enrollment.min.frames=3
# bioid.enrollment.max.attempts=5
# bioid.image.max.size.mb=10
# bioid.session.state.max.size=1048576
# bioid.credential.ttl.days=365

# =============================================================================
# MONITORING CONFIGURATION
# =============================================================================

# Monitoring Settings (System Properties - set via JVM args or config files)
# monitoring.enabled=false